# [设计模式](https://github.com/hadleysu/gitblog/issues/5)

# 设计模式

- [设计模式](#设计模式)
  - [学习方法](#学习方法)
  - [第一部分：基础知识](#第一部分基础知识)
    - [设计模式概述](#设计模式概述)
      - [设计模式从何而来](#设计模式从何而来)
      - [设计模式是什么](#设计模式是什么)
      - [设计模式有什么用](#设计模式有什么用)
    - [UML类图相关知识与面向对象设计原则](#uml类图相关知识与面向对象设计原则)
      - [UML类图相关知识](#uml类图相关知识)
      - [类之间的关系](#类之间的关系)
      - [7个面向对象设计原则](#7个面向对象设计原则)
  - [第二部分：创建型模型](#第二部分创建型模型)

书籍：设计模式的艺术

## 学习方法

在学习每个设计模式时至少应该掌握如下几点：这个设计模式的意图是什么，它要解决一个什么问题，什么时候可以使用它；它是如何解决问题的，掌握它的结构图，记住它的关键代码；能够想到至少两个它的应用实例，一个生活中的，一个软件中的；这个模式的优缺点是什么，在使用时要注意什么。

## 第一部分：基础知识

### 设计模式概述

- 设计模式从何而来？
- 设计模式是什么？
- 设计模式有什么用？

#### 设计模式从何而来

建筑学

#### 设计模式是什么

设计模式是软件设计过程中常见问题的典型解决方案。

#### 设计模式有什么用

设计模式提供了一种通用语言，可以帮助您的团队更有效地沟通。可以避免做一些重复性的工作，有助于提高设计和开发效率。

### UML类图相关知识与面向对象设计原则

- UML类图相关知识
- 7个面向对象设计原则

#### UML类图相关知识

UML（Unified Modeling Language，统一建模语言）。  
UML结构主要包括以下几个部分：

- 视图（View）：UML视图用于从不同的角度来表示待建模系统。包括用户视图、结构视图、行为视图、实现视图和环境视图。
- 图（Diagram）：UML图是描述UML视图内容的图形。13种图，分别是/用例图（Use Case Diagram）/、/类图（Class Diagram）、对象图（Object Diagram）、包图（Package Diagram）、组合结构图（Composite Structure Diagram）/、/状态图（State Diagram）、活动图（Activity Diagram）、顺序图（Sequence Diagram）、通信图（Communication Diagram）、定时图（Timing Diagram）、交互概览图（Interaction Overview Diagram）/、/组件图（Component Diagram）/和/部署图（Deployment Diagram）/，通过它们之间的相互结合可提供待建模系统的所有视图。
- 模型元素（Model Element）：模型元素是指UML图中所使用的一些概念，它们对应于普通的面向对象概念，如类、对象、消息以及这些概念之间的关系，如关联关系、依赖关系、泛化关系等。
- 通用机制（General Mechanism）：UML提供的通用机制为模型元素提供额外的注释、信息和语义，这些通用机制也提供了扩展机制，允许用户对UML进行扩展，如定义新的建模元素等等。

#### 类之间的关系

关联关系

- 双向关联
- 单向关联
- 自关联
- 多重性关联（表示两个关联对象在数量上的对应关系）
- 聚合关系（表示整体与部分的关系）
- 组合关系（也表示类之间整体和部分的关系，但是在组合关系中整体对象可以控制成员对象的生命周期）

依赖关系

- 在需要表示一个事物使用另一个事物时使用依赖关系。大多数情况下，**依赖关系体现在某个类的方法使用另一个类的对象作为参数**。
- 带箭头的虚线表示。

泛化关系

- 也就是继承关系，用于描述父类与子类之间的关系，父类又称作基类或超类，子类又称作派生类。在代码实现时，使用面向对象的**继承**机制来实现泛化关系，如在Java语言中使用**extends**关键字。
- 用带空心三角形的直线来表示。

接口与实现关系

- 在接口中，通常没有属性，而且所有的操作都是抽象的，只有操作的声明，没有操作的实现。**类实现了接口**，类中的操作实现了接口中所声明的操作。在Java语言中使用**implements**关键字。
- 类与接口之间的实现关系用带空心三角形的虚线来表示。

#### 7个面向对象设计原则

- 单一职责原则（Single Responsibility Principle，SRP）
  - 一个类只负责一个功能领域中的相应职责。或者可以定义为：就一个类而言，应该只有一个引起它变化的原因。
  - 单一职责原则是实现高内聚、低耦合的指导方针。
  
- 开闭原则（Open-Closed Principle，OCP）
  - 一个软件实体应当对扩展开放，对修改关闭。即软件实体应尽量在不修改原有代码的情况下进行扩展。
  - 为了满足开闭原则，需要对系统进行抽象化设计，抽象化是开闭原则的关键。
  - 在很多面向对象编程语言中都提供了接口、抽象类等机制，可以通过它们定义系统的抽象层，再通过具体类来进行扩展。
  
- 里氏代换原则（Liskov Substitution Principle，LSP）
  - 所有引用基类（父类）的地方必须能透明地使用其子类的对象。
  - 里氏代换原则表明，在软件中将一个基类对象替换成它的子类对象，程序将不会产生任何错误和异常，反过来则不成立。
  - 里氏代换原则是实现开闭原则的重要方式之一。在运用里氏代换原则时，应该将父类设计为抽象类或者接口，让子类继承父类或实现父接口，并实现在父类中声明的方法。程序运行时，子类实例替换父类实例，可以很方便地扩展系统的功能，无须修改原有子类的代码，增加新的功能可以通过增加一个新的子类来实现。
  - 在这个原则中，"父类"和"子类"的概念是广义的，它们可以是实际的父类和子类（通过继承关系），也可以是接口和实现接口的类（通过实现关系）。

- 依赖倒转原则（Dependency Inversion Principle，DIP）
  - 抽象不应该依赖于细节，细节应该依赖于抽象。换言之，要针对接口编程，而不是针对实现编程。
  - 在实现依赖倒转原则时，需要针对抽象层编程，而将具体类的对象通过依赖注入（Dependency Injection，DI）的方式注入其他对象中。
  - 常用的注入方式有3种：构造注入、设值注入（Setter注入）和接口注入。
  - 在大多数情况下，这3个设计原则会同时出现，开闭原则是目标，里氏代换原则是基础，依赖倒转原则是手段。

- 接口隔离原则（Interface Segregation Principle，ISP）
  - 使用多个专门的接口，而不使用单一的总接口，即客户端不应该依赖那些它不需要的接口。
  
- 合成复用原则（Composition/Aggregate Reuse Principle，CARP）
  - 尽量使用对象组合，而不是继承来达到复用的目的。
  - 简言之：复用时要尽量使用组合／聚合关系（关联关系），少用继承。
  - 在面向对象设计中，可以通过两种方法在不同的环境中复用已有的设计和实现，即通过组合／聚合关系（黑箱复用）或通过继承（白箱复用）。
  - 但首先应该考虑使用组合／聚合，组合／聚合可以使系统更加灵活，降低类与类之间的耦合度，一个类的变化对其他类造成的影响相对较少。其次才考虑继承，在使用继承时，需要严格遵循里氏代换原则，有效使用继承会有助于对问题的理解，降低复杂度。
  - 如果两个类之间是“Has-A”的关系，应使用组合或聚合；如果是“Is-A”关系，可使用继承。

- 迪米特法则（Law of Demeter，LoD）
  - 一个软件实体应当尽可能少地与其他实体发生相互作用。这是对软件实体之间通信的限制。
  - 迪米特法则可降低系统的耦合度，使类与类之间保持松散的耦合关系。
  - 如果其中一个对象需要调用另一个对象的方法，可以通过第三者转发这个调用。简言之，就是通过引入一个合理的第三者来降低现有对象之间的耦合度。

## 第二部分：创建型模型


